---
title: "Next.js에서 서버 사이드 렌더링과 서스펜스 스트리밍 전략의 최적화"
summary: Next.js의 서버 사이드 렌더링과 서스펜스 스트리밍 전략을 활용하여 웹 애플리케이션의 성능과 사용자 경험을 극대화하는 방법을 살펴봅니다.
tags: ['SSR', 'Suspense', 'Streaming', 'Rendering']
images: ['/static/images/blog/nextjs/server-rendering.jpg']
date: "2024-04-15 09:00"
---

<TOCInline toc={props.toc} asDisclosure />

## 서론: Next.js의 렌더링 전략과 그 중요성

### Next.js와 렌더링 전략

Next.js는 현대적 웹 애플리케이션 개발에 있어서 필수적인 프레임워크 중 하나로 자리 잡았습니다. 특히 서버 사이드 렌더링과 같은 렌더링 전략은 애플리케이션의 성능을 크게 향상시킬 수 있는 요소입니다. 렌더링 방식을 적절히 선택하면 초기 로딩 시간을 단축시키고 검색 엔진 최적화(SEO)를 향상시킬 수 있습니다. 이러한 전략들은 사용자 경험을 직접적으로 개선하는 데에 큰 역할을 합니다.

### 서버 사이드 렌더링과 서스펜스 스트리밍 소개

서버 사이드 렌더링은 사용자의 요청에 따라 서버에서 HTML을 먼저 생성하고 이를 클라이언트로 전송하는 방식입니다. 이 방법은 특히 초기 페이지 로딩 속도가 중요한 서비스에 적합하며 렌더링 과정에서 필요한 자바스크립트 코드량을 줄여 빠르게 컨텐츠를 사용자에게 제공할 수 있습니다.

서스펜스 스트리밍은 리액트의 지연 로딩 컴포넌트를 활용하여 서버에서 클라이언트로의 컨텐츠 전송을 최적화하는 기술입니다. 이는 데이터를 필요로 하는 컴포넌트가 데이터를 기다리는 동안 대체 컨텐츠를 보여주고 준비된 데이터와 함께 실제 컨텐츠를 점진적으로 렌더링함으로써 사용자의 대기 시간을 줄여줍니다.


## 서버 사이드 렌더링: 웹 애플리케이션의 신속한 데이터 반영과 성능 향상

### 서버 사이드 렌더링의 원리와 필요성

서버 사이드 렌더링(SSR)은 웹 페이지를 서버에서 렌더링하는 기술로, 사용자의 요청에 따라 서버에서 초기 HTML을 생성하여 전송합니다. 이 방식은 웹 애플리케이션의 초기 로딩 속도를 향상시키며 클라이언트 측의 자바스크립트 처리 부담을 감소시킵니다. 또한, 검색 엔진 최적화(SEO)에 유리하여 웹 페이지의 검색 엔진 노출도를 높일 수 있는 장점이 있습니다.

### SSR의 장점

1. **초기 로딩 시간 단축**: 사용자는 데이터를 기다리지 않고 바로 웹 페이지를 볼 수 있습니다. 이는 특히 초기 콘텐츠 로딩 시간이 중요한 서비스에서 유저 경험을 크게 향상시킵니다.
2. **검색 엔진 최적화**: 서버 사이드 렌더링된 페이지는 검색 엔진에 의해 더 잘 인식되고 분석됩니다. 이는 검색 결과에서의 더 높은 랭킹을 의미하며, 결과적으로 트래픽 증가로 이어질 수 있습니다.
3. **리소스 효율성**: 클라이언트의 자바스크립트 처리 부담이 줄어들어, 저사양의 기기에서도 웹 페이지의 접근성이 향상됩니다.

### 실시간 데이터 반영을 위한 SSR 적용

Next.js의 실시간 데이터를 반영하는 SSR 예제는 다음과 같습니다. 이 예제에서는 사용자의 요청에 따라 동적으로 데이터를 서버에서 가져와 렌더링합니다.

```javascript
import { fetchProductDetails } from '@/api';

// 서버 사이드에서 동적 데이터를 가져오는 함수
async function fetchData(productId) {
  const data = await fetchProductDetails(productId);
  return data;
}

// App Router를 사용한 서버 사이드 렌더링
export default async function ProductPage({ params }) {
  const productDetails = await fetchData(params.productId);

  return (
    <article>
      <h1>{productDetails.name}</h1>
      <p>{productDetails.description}</p>
      <strong>가격: {productDetails.price}원</strong>
    </article>
  );
}
```

위 코드에서 `fetchProductDetails`는 외부 API나 데이터베이스로부터 상품 정보를 가져오는 함수입니다. 서버 사이드에서 이 함수를 호출하며, 결과적으로 사용자는 요청과 거의 동시에 최신 데이터가 반영된 웹 페이지를 볼 수 있습니다.

서버 사이드 렌더링은 특히 데이터가 자주 업데이트되는 웹 애플리케이션에 적합합니다. 이 기술을 활용하면 사용자가 항상 최신 정보를 바탕으로 의사 결정을 할 수 있으며, 애플리케이션의 전반적인 사용자 경험을 개선할 수 있습니다.


## 서스펜스 스트리밍의 이해와 적용

웹 애플리케이션의 사용자 경험을 향상시키는 중요한 방법 중 하나는 데이터 로딩을 어떻게 관리하느냐에 달려 있습니다. 최신 웹 개발에서는 사용자의 불편을 최소화하면서 데이터를 효율적으로 로딩하는 다양한 기술이 사용됩니다. 이번 글에서는 서스펜스 기능과 스트리밍을 활용한 데이터 로딩 기법에 대해 알아보겠습니다.

### 서스펜스와 스트리밍의 역할

서스펜스는 리액트가 데이터 로딩을 기다리는 동안 대체 UI를 보여주는 기능을 제공합니다. 이를 통해 전체 페이지가 준비될 때까지 사용자가 화면상에서 아무것도 볼 수 없는 상황을 방지할 수 있습니다. 데이터가 필요한 컴포넌트를 서스펜스 경계로 감싸면, 해당 데이터가 준비될 때까지 설정한 대체 UI가 화면에 표시됩니다.

스트리밍은 서버로부터 받아야 할 데이터가 많을 때, 이를 여러 작은 부분으로 나눠서 점진적으로 로드하고 사용자에게 보여주는 방식입니다. 이 방법은 초기 로딩 시간을 크게 단축시키고, 사용자가 데이터를 기다리는 동안에도 일부 정보를 빠르게 접할 수 있게 해줍니다.

### 데이터 로딩 시점의 관리

데이터 로딩의 시점을 효과적으로 관리하는 것은 웹 성능 최적화에서 중요한 요소입니다. 사용자가 실제로 필요로 하는 시점에 데이터를 로드하도록 계획함으로써, 불필요한 데이터 전송을 줄이고, 애플리케이션의 반응성을 높일 수 있습니다. 예를 들어, 메인 콘텐츠는 우선 로드하고, 그 외의 정보는 사용자가 해당 영역으로 스크롤할 때 로드하는 방식이 이에 해당합니다.

### 청크별 데이터 전송의 장점

큰 용량의 데이터를 작은 청크로 나누어 전송하는 스트리밍 방식은 여러 장점을 가집니다. 첫째, 사용자는 데이터의 일부라도 빠르게 볼 수 있어 애플리케이션의 반응성이 좋다고 느낄 수 있습니다. 둘째, 네트워크 상황이 좋지 않을 때도 사용자에게 최소한의 콘텐츠를 빠르게 제공할 수 있어, 전반적인 사용자 경험을 개선합니다.

### 적용 예시

Next.js 프로젝트에서 서스펜스와 데이터 스트리밍을 적용하는 간단한 예제를 보겠습니다. 여기서는 `fetch` API를 사용하여 데이터를 비동기적으로 로드하고, 서스펜스 기능을 활용하여 로딩 중에는 대체 UI를 보여주는 방식을 사용합니다.

```javascript
import { Suspense } from 'react';

function ProductList() {
  const products = fetch('/api/products').then(res => res.json());

  return (
    <Suspense fallback={<div>상품 로딩 중...</div>}>
      <ul>
        {products.map(product => (
          <li key={product.id}>{product.name}</li>
        ))}
      </ul>
    </Suspense>
  );
}
```

이 코드는 상품 목록을 서버에서 불러와 화면에 표시하는 간단한 컴포넌트입니다. `Suspense` 컴포넌트를 사용하여 데이터 로딩 중에는 "상품 로딩 중..."이라는 메시지를 보여줍니다. 데이터가 준비되면 바로 상품 목록을 표시합니다.

서스펜스와 스트리밍은 현대 웹에서 데이터를 효율적으로 처리하고 사용자 경험을 향상시키는 데 필수적인 기술입니다. 이러한 기법을 적절히 활용한다면, 사용자는 더 빠르고 부드러운 인터랙션을 경험할 수 있습니다.


### 증분적 정적 재생성(ISR)과 정적 사이트 생성(SSG)의 비교

#### ISR의 도입 배경과 주요 사용 시나리오

증분적 정적 재생성(ISR)은 실시간 데이터 업데이트의 필요성과 웹 페이지의 빠른 로딩을 동시에 충족시키기 위해 개발되었습니다. 정적 사이트 생성(SSG) 방식에서는 모든 페이지를 빌드 시점에 생성하며, 이는 변경이 빈번한 콘텐츠에는 제한적입니다. ISR은 이러한 한계를 극복하고자 특정 시간 간격 후에 페이지를 자동으로 갱신하는 기능을 제공하여, 뉴스 사이트나 전자 상거래 플랫폼과 같이 실시간 정보가 중요한 곳에서 효과적으로 사용됩니다.

#### SSG 대비 ISR의 장점과 애플리케이션 성능에 미치는 영향

SSG는 사이트의 로딩 속도 개선과 서버 부하 감소 등의 장점이 있지만, 콘텐츠 업데이트가 잦은 경우 전체 사이트의 재빌드가 필요합니다. ISR은 이를 개선하여 정해진 시간마다 필요한 페이지만을 재생성함으로써 최신 데이터를 제공하고, 이는 서버 효율성을 크게 향상시킵니다. `fetch()` 함수의 `revalidate` 옵션을 사용하여 이를 구현하며, 예를 들어 `revalidate: 60`은 자원을 60초 동안 캐시한 후 자동으로 재검증합니다. 이는 서버 부하를 줄이면서 사용자에게 최신 정보를 지속적으로 제공하는 데 중요합니다.

### 코드 예제: ISR 구현 방법

앱 라우터 방식에서 ISR을 구현하는 예제는 아래와 같습니다. 이 예제는 `fetch()` 함수를 사용하여 데이터를 가져오고, `revalidate` 옵션을 설정하여 정적 사이트의 데이터를 주기적으로 갱신합니다.

```javascript
// `app` 폴더 내에 위치한 파일 예제
async function getPosts() {
  const res = await fetch('https://api.example.com/posts', {
    headers: {
      'Content-Type': 'application/json'
    },
    next: { revalidate: 60 } // 60초 후에 데이터 재검증
  });
  const data = await res.json();
  return data.posts;
}

export default async function PostList() {
  const posts = await getPosts();
  return (
    <ul>
      {posts.map(post => (
        <li key={post.id}>{post.title}</li>
      ))}
    </ul>
  );
}
```

이 코드는 서버에서 데이터를 가져올 때마다 설정된 시간(여기서는 60초) 후에 자동으로 데이터를 재검증하고 캐시를 갱신하여 최신 상태를 유지합니다. 이러한 방식은 특히 데이터가 자주 변경되는 웹 애플리케이션에서 유용하게 사용됩니다.

## 결론: Next.js의 렌더링 전략을 활용한 효율적 웹 애플리케이션 구축

Next.js의 서버 사이드 렌더링(SSR)과 서스펜스 스트리밍, 그리고 증분적 정적 재생성(ISR)은 현대 웹 애플리케이션의 성능과 사용자 경험을 극대화하는 핵심 기술입니다. 이러한 기술들은 개발자가 웹 페이지의 초기 로딩 속도를 단축하고, 검색 엔진 최적화를 개선하며, 최신 데이터를 효과적으로 반영할 수 있게 도와줍니다.

SSR은 특히 초기 페이지 로딩 속도가 중요한 서비스에 필수적인 기술로, 사용자가 웹 사이트에 처음 방문할 때 빠르게 콘텐츠를 제공함으로써 뛰어난 첫 인상을 심어줄 수 있습니다. 이는 사용자의 사이트 잔류 시간을 늘리고, 전환율을 개선하는 데 직접적인 영향을 미칩니다.

서스펜스 스트리밍은 사용자가 데이터 로딩을 기다리는 동안에도 페이지의 일부를 빠르게 탐색할 수 있도록 함으로써 전체적인 사용자 경험을 향상시킵니다. 이 기술은 특히 대용량의 데이터를 다루는 애플리케이션에서 그 가치가 빛납니다.

ISR은 정적 사이트 생성(SSG)의 한계를 넘어서는 또 다른 뛰어난 기술로, 사이트의 콘텐츠가 자주 업데이트되어야 할 때 매우 유용합니다. 정해진 간격으로 자동으로 페이지를 재생성함으로써 최신 정보를 제공하고 이를 통해 사용자에게는 항상 최신의 콘텐츠를 보여줄 수 있습니다.

이러한 기술들을 적절히 활용함으로써 개발자는 서버 부하를 최소화하고 사용자에게 더 나은 서비스를 제공할 수 있습니다. 최종적으로 이는 기업의 브랜드 가치를 향상시키고 사용자의 만족도를 높이는 결과로 이어집니다. Next.js를 사용하는 것은 단순히 기술적인 선택을 넘어서, 사용자 중심의 효과적인 웹 경험을 설계하는 전략적 결정이라 할 수 있습니다.


